{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h2>Chart of Accounts</h2>
    <a href="{{ url_for('accounts.add_account') }}" class="btn btn-primary mb-3">Add New Account</a>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Account Number</th>
                <th>Account Name</th>
                <th>Account Type</th>
                <th>Parent Account</th>
                <th>Active</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for account in accounts %}
            <tr>
                <td>{{ account.account_number }}</td>
                <td>{{ account.account_name }}</td>
                <td>{{ account.account_type_rel.name }}</td>
                <td>{{ account.parent.account_name if account.parent else 'N/A' }}</td>
                <td>{{ 'Yes' if account.is_active else 'No' }}</td>
                <td>
                    <a href="{{ url_for('accounts.edit_account', account_id=account.id) }}" class="btn btn-sm btn-warning">Edit</a>
                    <form action="{{ url_for('accounts.delete_account', account_id=account.id) }}" method="POST" class="d-inline">
                        {{ delete_form.hidden_tag() }} {# CSRF Token #}
                        <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this account?');">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

{# filepath: georgian_accounting/templates/_form_helpers.html #}
{% macro render_field(field, **kwargs) %}
  <div class="mb-3">
    {{ field.label(class="form-label") }}
    {{ field(**kwargs) }}
    {% if field.errors %}
      <div class="invalid-feedback d-block">
        {% for error in field.errors %}
          <span>{{ error }}</span>
        {% endfor %}
      </div>
    {% endif %}
  </div>
{% endmacro %}